<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>问答系统</title>
    <link rel="stylesheet" href="/static/css/style.css"/>
    <!-- 新增：删除按钮样式（尽量与现有样式兼容） -->
    <style>
        /* filepath: c:\Users\w3113\Desktop\teacher-agent\templates\index.html (style additions) */
        .thread-item, .doc-item {
            position: relative;
            padding-right: 60px; /* 给删除按钮留出位置 */
        }
        .item-delete-btn {
            position: absolute;
            right: 8px;
            top: 8px;
            display: none;
            background: #e74c3c;
            color: #fff;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .thread-item:hover .item-delete-btn,
        .doc-item:hover .item-delete-btn {
            display: inline-block;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
</head>
<body>
    <div class="container">
        <nav>
            <span>已登录：{{ user }}</span>
            <a href="/logout" style="margin-left:10px;">退出登录</a>
        </nav>

        <h1>问答系统</h1>

        <!-- 三列布局：left / center(segments) / right(chat) -->
        <div class="layout three-col">
            <div class="left">
                <div style="margin-bottom:8px;">
                    <button onclick="createThreadPrompt()">新建会话</button>
                    <button onclick="loadThreads()">刷新会话</button>
                </div>

                <div>
                    <h4>会话</h4>
                    <div id="threadList">加载中...</div>
                </div>

                <div style="margin-top:12px;">
                    <h4>已上传文件</h4>
                    <div id="docList">加载中...</div>
                    <div style="margin-top:6px;">
                        <button onclick="loadDocuments()">刷新文件列表</button>
                    </div>
                </div>
            </div>

            <div class="center">
                <h4>文档分段预览</h4>
                <div id="segments">请选择左侧文件查看分段预览</div>
            </div>

            <div class="main">
                <div class="chat-header">
                    <strong>当前会话：</strong><span id="currentThread">无（新建或选择会话）</span>
                </div>

                <div id="messages" class="chat-window">请选择或新建会话以查看消息</div>

                <div class="chat-input">
                    <textarea id="question" placeholder="请输入你的问题..." style="height:72px"></textarea>
                    <div class="chat-actions">
                        <button onclick="askQuestion()">提交问题</button>
                    </div>
                </div>

                <div style="margin-top:12px">
                    <h4>上传文档</h4>
                    <input type="file" id="fileInput" accept=".pdf,.docx">
                    <button onclick="uploadFile()">上传文档</button>
                    <div id="uploadResponse" class="response" style="display: none;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 把内联脚本替换为外部脚本引用，方便维护 -->
	<script src="/static/js/app.js"></script>
</body>
</html>